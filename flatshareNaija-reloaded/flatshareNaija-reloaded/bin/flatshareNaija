#!/usr/bin/env zsh
set -euo pipefail
APP_ROOT="${0:a:h:h}"
cmd="${1:-help}"; shift || true

case "$cmd" in
  init)  mkdir -p "$APP_ROOT/db"; sqlite3 "$APP_ROOT/db/flatshare.db" < "$APP_ROOT/db/migrations/001_init.sql" ;;
  user)  exec "$APP_ROOT/bin/fsn-user" "$@" ;;
  pref)  exec "$APP_ROOT/bin/fsn-pref" "$@" ;;
  listing) exec "$APP_ROOT/bin/fsn-listing" "$@" ;;
  match) exec "$APP_ROOT/bin/fsn-match" "$@" ;;
  help|*) cat <<'USAGE'
FlatshareNaija-reloaded CLI

Usage:
  flatshareNaija init
  flatshareNaija user add <name> <email> <phone> <city>
  flatshareNaija pref set <user> <budget> <city> <area> <lifestyle>
  flatshareNaija listing add <title> <desc> <city> <area> <rent>
  flatshareNaija listing search <city> <area> <max>
  flatshareNaija match <user>
USAGE
    ;;
esac
