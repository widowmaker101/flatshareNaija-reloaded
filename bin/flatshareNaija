#!/usr/bin/env zsh
set -euo pipefail
APP_ROOT="${0:a:h:h}"
source "$APP_ROOT/lib/common.zsh"

cmd="${1:-help}"; shift || true

case "$cmd" in
  init)    exec "$APP_ROOT/bin/fsn-init" "$@" ;;
  user)    exec "$APP_ROOT/bin/fsn-user" "$@" ;;
  pref)    exec "$APP_ROOT/bin/fsn-pref" "$@" ;;
  listing) exec "$APP_ROOT/bin/fsn-listing" "$@" ;;
  match)   exec "$APP_ROOT/bin/fsn-match" "$@" ;;
  search)  exec "$APP_ROOT/bin/fsn-search" "$@" ;;
  import)  exec "$APP_ROOT/bin/fsn-import" "$@" ;;
  export)  exec "$APP_ROOT/bin/fsn-export" "$@" ;;
  backup)  exec "$APP_ROOT/bin/fsn-backup" "$@" ;;
  tui)     exec "$APP_ROOT/bin/fsn-tui" "$@" ;;
  help|*)
    cat <<'USAGE'
FlatshareNaija CLI

Commands:
  init                      Initialize database
  user add/list             Manage users
  pref set/list             Manage preferences
  listing add/search        Manage and search listings
  match <user>              Match listings for user
  search "<query>"          Natural-language search
  import csv <file>         Import listings from CSV
  export [csv|json]         Export listings
  backup                    Backup database
  tui                       Interactive text UI
USAGE
    ;;
esac
